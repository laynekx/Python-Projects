deck = []
deck_value = {
    "A" : 11, 
    "2" : 2,
    "3" : 3,
    "4" : 4,
    "5" : 5,
    "6" : 6,
    "7" : 7,
    "8" : 8,
    "9" : 9,
    "10" : 10,
    "J" : 10,
    "Q" : 10,
    "K" : 10,
  }

for i in deck_value:
    deck.append(f"{i} \u2660")
    deck.append(f"{i} \u2663")
    deck.append(f"{i} \u2665")
    deck.append(f"{i} \u2666")

import random

def deal_cards(cards_set):
    card = random.choice(deck)
    cards_set.append(card)
    deck.remove(card)

def calculate_score(cards_set):
    '''returns sum of cards or 0 if blackjack or changes ace from 11 to 1 as necessary'''
    sum = 0
    for i in cards_set:
        card_value = i[0]
        if card_value == "1":
            card_value = "10"
        sum += deck_value[card_value]
        if sum > 21 and card_value == "A":
            sum -= 10
    if sum == 21 and len(cards_set) == 2:
        return 0
    return sum


def win_lose(user, computer, money):
    '''prints winner and changes pot money accordingly.'''
    earnings = 0
    if user == computer:
            print(f"The game is tied!")
            earnings -= (money/2)
    elif user == 0:
        print(f" You win with a blackjack!")
        earnings += money
    elif computer == 0:
        print(f"Computer wins with a blackjack!")
        earnings -= money
    elif computer > 21:
        print(f"Computer goes over. You win!")
        earnings += money
    elif user > 21:
        print(f"You go over. Computer wins!")
        earnings -= money
    elif user <= 21:
        if computer > user:
            print(f"Computer wins!")
            earnings -= money
        else:
            print(f"You win!")
            earnings += money
    elif computer <= 21:
        if computer > user:
            print(f"Computer wins!")
            earnings -= money
        else:
            print(f"You win!")
            earnings += money
    return earnings


def option():
    '''checks correctness of response'''
    choice = input("Type 'y' to get another card, type 'n' to pass: ").lower()
    if choice == 'y':
        return 'y'
    elif choice == 'n':
        return 'n'
    

def bet():
    while True:
        bet = input('How much do you want to bet?')
        if bet.replace('.', '').replace('-', '').isdigit() or bet.isdigit():
            return float(bet)
        else:
            print('Invalid input')

def continue_game():
    while True:
        choice = input("Do you want to continue playing?").lower()
        if choice == "y":
            return True
        elif choice == "n":
            return False

def start_game():
    while True:
        choice = input("Do you want to play a game of blackjack?").lower()
        if choice == "y":
            return True
        elif choice == "n":
            return False  
        

def blackjack():
    user_cards = []
    computer_cards = []
    pot = 0

    for _ in range(2):
        deal_cards(user_cards)
        deal_cards(computer_cards)

    while calculate_score(computer_cards) < 17:
        deal_cards(computer_cards)

    bet_on = True
    while bet_on:
        money = bet()
        pot += money
        user_score = calculate_score(user_cards)
        computer_score = calculate_score(computer_cards)
        print(f"Your cards: {user_cards}, current score: {user_score}")
        print(f"Computer's first card: {computer_cards[0]}")
        if user_score == 0 or computer_score == 0 or user_score > 21 or computer_score > 21:
            bet_on = False
        else:
            choice = option()
            if choice == "y":
                deal_cards(user_cards)
            else:
                bet_on = False
    
    print(f"Your final hand: {user_cards}, score: {user_score}")
    print(f"Computer's final hand: {computer_cards}, score: {computer_score}")
    earnings = win_lose(user_score, computer_score, pot)
    if earnings > 0:
        print(f"Congratulations! You won ${earnings}")
    else:
        earnings = abs(earnings)
        print(f"Dealer wins ${earnings}.")
    if continue_game():
            blackjack()

if start_game():
    blackjack()